(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{279:function(e,t,a){e.exports=a.p+"assets/img/path-done.ceae32b9.png"},433:function(e,t,a){"use strict";a.r(t);var s=a(10),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"patching-bus-ids"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#patching-bus-ids"}},[e._v("#")]),e._v(" Patching Bus IDs")]),e._v(" "),t("p",[e._v("This section is mainly relevant for those who cannot use certain display outputs regardless of the connector-type or SMBIOS patch, as Apple has hardcoded the output BusIDs in a way that doesn't match your hardware. To resolve, we'll be manually patching these bus IDs into supporting our hardware.")]),e._v(" "),t("p",[e._v("This page will be a bit more technical as we've assumed you've read through the previous pages and have a decent grasp of WhateverGreen.")]),e._v(" "),t("ul",[t("li",[t("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/connector.html"}},[e._v("Patching the display type")])],1),e._v(" "),t("li",[t("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/vram.html"}},[e._v("Patching the VRAM requirement of macOS")])],1)]),e._v(" "),t("h2",{attrs:{id:"parsing-the-framebuffer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parsing-the-framebuffer"}},[e._v("#")]),e._v(" Parsing the framebuffer")]),e._v(" "),t("p",[e._v("To start, let's assume we're using a Z390 board with a UHD 630. This system is iGPU-only in macOS and has issues with using certain display-outs, and is using the "),t("code",[e._v("0x3E9B0007")]),e._v(" framebuffer.")]),e._v(" "),t("p",[e._v("When we look at this framebuffer from "),t("a",{attrs:{href:"https://github.com/acidanthera/WhateverGreen/blob/master/Manual/FAQ.IntelHD.en.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("WhateverGreen's manual"),t("OutboundLink")],1),e._v(", we see the following:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("ID: 3E9B0007, STOLEN: 57 MB, FBMEM: 0 bytes, VRAM: 1536 MB, Flags: 0x00801302\nTOTAL STOLEN: 58 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 172 MB, MAX OVERALL: 173 MB (181940224 bytes)\nGPU Name: Intel UHD Graphics 630\nModel Name(s):\nCamelia: Disabled\nMobile: 0, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),t("p",[e._v("Now let's parse it down to the BusID information, as this is what we will be patching:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),t("p",[e._v("Here we see that this framebuffer personality has 3 Bus IDs listed, let's try to break them down to be a bit more understandable. Let's take entry 1:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n")])])]),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"left"}},[e._v("Bit")]),e._v(" "),t("th",{staticStyle:{"text-align":"left"}},[e._v("Name")]),e._v(" "),t("th",{staticStyle:{"text-align":"left"}},[e._v("Value")])])]),e._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Bit 1")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Port")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[t("code",[e._v("01")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Bit 2")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Bus ID")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[t("code",[e._v("05")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Bit 3-4")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Pipe Number")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[t("code",[e._v("0900")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Bit 5-8")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Connector Type")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[t("code",[e._v("00040000")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"left"}},[e._v("Bit 9-12")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[e._v("Flags")]),e._v(" "),t("td",{staticStyle:{"text-align":"left"}},[t("code",[e._v("C7030000")])])])])]),e._v(" "),t("p",[e._v("Things to keep in mind:")]),e._v(" "),t("ul",[t("li",[e._v("BusID is a unique value and cannot be used by multiple entries")]),e._v(" "),t("li",[e._v("Connector-type values are the same as discussed in the "),t("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/connector.html"}},[e._v("Connector-type patching page")])],1)]),e._v(" "),t("h2",{attrs:{id:"mapping-the-video-ports"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mapping-the-video-ports"}},[e._v("#")]),e._v(" Mapping the video ports")]),e._v(" "),t("p",[e._v("Here we have 2 sections:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#mapping-withinb-macos"}},[e._v("Mapping within macOS")]),e._v(" "),t("ul",[t("li",[e._v("You can boot macOS and use at least 1 display")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#mapping-without-macos"}},[e._v("Mapping without macOS")]),e._v(" "),t("ul",[t("li",[e._v("Blackscreen on all displays")])])])]),e._v(" "),t("h3",{attrs:{id:"mapping-within-macos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mapping-within-macos"}},[e._v("#")]),e._v(" Mapping within macOS")]),e._v(" "),t("p",[e._v("Mapping videos in macOS is fairly easy, as we can assume that one of our ports is mapped correctly in the framebuffer.")]),e._v(" "),t("p",[e._v("For this example, we'll explain the common "),t("a",{attrs:{href:"https://dortania.github.io/OpenCore-Install-Guide/config-laptop.plist/kaby-lake.html#deviceproperties",target:"_blank",rel:"noopener noreferrer"}},[e._v("HDMI-hotplug fix for Kaby lake users"),t("OutboundLink")],1),e._v(". To start, lets look at the "),t("code",[e._v("0x591B0000")]),e._v(" framebuffer:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("ID: 591B0000, STOLEN: 38 MB, FBMEM: 21 MB, VRAM: 1536 MB, Flags: 0x0000130B\nTOTAL STOLEN: 39 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 136 MB, MAX OVERALL: 137 MB (144191488 bytes)\nModel name: Intel HD Graphics KBL CRB\nCamellia: CamelliaDisabled (0), Freq: 1388 Hz, FreqMax: 1388 Hz\nMobile: 1, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[0] busId: 0x00, pipe: 8, type: 0x00000002, flags: 0x00000098 - ConnectorLVDS\n[2] busId: 0x04, pipe: 10, type: 0x00000800, flags: 0x00000187 - ConnectorHDMI\n[3] busId: 0x06, pipe: 10, type: 0x00000400, flags: 0x00000187 - ConnectorDP\n00000800 02000000 98000000\n02040A00 00080000 87010000\n03060A00 00040000 87010000\n")])])]),t("p",[e._v("Here we see that entry 2 is the HDMI port however on a real Kaby lake laptop it's very common for hot plug to kernel panic the machine. This is due to the bus ID and port not aligning perfectly with the hardware.")]),e._v(" "),t("p",[e._v("To resolve, we'll want to patch it to something more appropriate(ie. "),t("code",[e._v("0204")]),e._v(" to "),t("code",[e._v("0105")]),e._v(", these have been tested to work properly)")]),e._v(" "),t("p",[e._v("There are 2 ways to patch:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#replace-the-entire-entry"}},[e._v("Replace the entire entry")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#replace-sectons-of-the-entry"}},[e._v("Replace sections of the entry")])])]),e._v(" "),t("h4",{attrs:{id:"replace-the-entire-entry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#replace-the-entire-entry"}},[e._v("#")]),e._v(" Replace the entire entry")]),e._v(" "),t("p",[e._v("To replace the entire entry, we'll first want to locate our entry and ensure it's enumerated correctly. This is because Apple's has entries starting at 0 and progresses through that:")]),e._v(" "),t("ul",[t("li",[e._v("con0")]),e._v(" "),t("li",[e._v("con1")]),e._v(" "),t("li",[e._v("con2")])]),e._v(" "),t("p",[e._v("So since entry 2 is the second in the list, we'll want to use con1:")]),e._v(" "),t("ul",[t("li",[e._v("framebuffer-con2-enable")])]),e._v(" "),t("p",[e._v("Next lets make the patch, we know that port needs to be patched to "),t("code",[e._v("01")]),e._v(" and BusID changed to "),t("code",[e._v("05")]),e._v(":")]),e._v(" "),t("ul",[t("li",[t("code",[t("strong",[e._v("0105")]),e._v("0A00 00080000 87010000")])])]),e._v(" "),t("p",[e._v("And finally, we're given the following patches:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con2-alldata | Data | `01050A00 00080000 87010000`\n")])])]),t("h4",{attrs:{id:"replace-sections-of-the-entry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#replace-sections-of-the-entry"}},[e._v("#")]),e._v(" Replace sections of the entry")]),e._v(" "),t("p",[e._v("To replace sections of the entry, we'll first want to locate our entry and ensure it's enumerated correctly. This is because Apple's has entries starting at 0 and progresses through that:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("con0")])]),e._v(" "),t("li",[t("code",[e._v("con1")])]),e._v(" "),t("li",[t("code",[e._v("con2")])])]),e._v(" "),t("p",[e._v("So since entry 2 is the second in the list, we'll want to use con1:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("framebuffer-con1-enable")])])]),e._v(" "),t("p",[e._v("Next lets make the patch, we know that port needs to be patched to 01 and BusID changed to 05:")]),e._v(" "),t("ul",[t("li",[e._v("framebuffer-con2-index = "),t("code",[e._v("01")])]),e._v(" "),t("li",[e._v("framebuffer-con2-busid = "),t("code",[e._v("05")])])]),e._v(" "),t("p",[e._v("And finally, we get these patches:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con2-index   | Data | `01`\nframebuffer-con2-busid   | Data | `05`\n")])])]),t("h3",{attrs:{id:"mapping-without-macos"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mapping-without-macos"}},[e._v("#")]),e._v(" Mapping without macOS")]),e._v(" "),t("p",[e._v("Mapping your display outs is fairly simple, "),t("em",[e._v("however")]),e._v(" is quite time consuming as you need to try every BusID value until you get an output.")]),e._v(" "),t("p",[e._v("For this example, we'll use the 0x3E9B0007 framebuffer again.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),t("p",[e._v("To start, we'll be trying to go through entry 1's BusIDs in hope we find working value.")]),e._v(" "),t("h5",{attrs:{id:"_1-here-plug-in-your-hdmi-display"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-here-plug-in-your-hdmi-display"}},[e._v("#")]),e._v(" 1. Here plug in your HDMI display")]),e._v(" "),t("h5",{attrs:{id:"_2-set-port-1-to-the-hdmi-connector-type"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-set-port-1-to-the-hdmi-connector-type"}},[e._v("#")]),e._v(" 2. Set Port 1 to the HDMI connector type")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("01xx0900 "),t("strong",[e._v("00080000")]),e._v(" C7030000")])])]),e._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[e._v("Supported Connector Types")]),e._v(" "),t("p",[e._v("Common connector types supported in macOS")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("<02 00 00 00>        LVDS and eDP      - Laptop displays\n<10 00 00 00>        VGA               - Unsupported in 10.8 and newer\n<00 04 00 00>        DisplayPort       - USB-C display-out are DP internally\n<01 00 00 00>        DUMMY             - Used when there is no physical port\n<00 08 00 00>        HDMI\n<80 00 00 00>        S-Video\n<04 00 00 00>        DVI (Dual Link)\n<00 02 00 00>        DVI (Single Link)\n")])])]),t("p",[e._v("Reminder that VGA on Skylake and newer are actually DisplayPort internally, so use that connector type instead.")])]),e._v(" "),t("h5",{attrs:{id:"_3-disable-ports-2-and-3-with-busid-00"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-disable-ports-2-and-3-with-busid-00"}},[e._v("#")]),e._v(" 3. Disable ports 2 and 3 with busid=00")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("02"),t("strong",[e._v("00")]),e._v("0A00 00040000 C7030000")])]),e._v(" "),t("li",[t("code",[e._v("03"),t("strong",[e._v("00")]),e._v("0800 00040000 C7030000")])])]),e._v(" "),t("h5",{attrs:{id:"_4-walk-through-busids-for-port-1-if-the-previous-didn-t-work-the-maximum-busid-on-most-platforms-generally-0x06"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-walk-through-busids-for-port-1-if-the-previous-didn-t-work-the-maximum-busid-on-most-platforms-generally-0x06"}},[e._v("#")]),e._v(" 4. Walk through busids for Port 1 if the previous didn't work. The maximum busid on most platforms generally 0x06")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("01"),t("strong",[e._v("01")]),e._v("0900 00080000 C7030000")])]),e._v(" "),t("li",[t("code",[e._v("01"),t("strong",[e._v("02")]),e._v("0900 00080000 C7030000")])]),e._v(" "),t("li",[t("code",[e._v("01"),t("strong",[e._v("03")]),e._v("0900 00080000 C7030000")])]),e._v(" "),t("li",[e._v("etc")])]),e._v(" "),t("p",[e._v("If you still get no output, set port 1's busid to 00 and start going through busids for port 2 and so on")]),e._v(" "),t("ul",[t("li",[e._v("port 1 = "),t("code",[e._v("01000900 00040000 C7030000")])]),e._v(" "),t("li",[e._v("port 2 = "),t("code",[e._v("02"),t("strong",[e._v("xx")]),e._v("0A00 00080000 C7030000")])]),e._v(" "),t("li",[e._v("port 3 = "),t("code",[e._v("03000800 00040000 C7030000")])])]),e._v(" "),t("h4",{attrs:{id:"adding-to-your-config-plist"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#adding-to-your-config-plist"}},[e._v("#")]),e._v(" Adding to your config.plist")]),e._v(" "),t("p",[e._v("You'll now want to add the following patches to "),t("code",[e._v("DeviceProperteies -> Add -> PciRoot(0x0)/Pci(0x2,0x0)")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con0-enable  | Data | `01000000`\nframebuffer-con1-enable  | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con0-alldata | Data | port 1 (ie. `01010900 00080000 C7030000`)\nframebuffer-con1-alldata | Data | port 2 (ie. `02000A00 00040000 C7030000`)\nframebuffer-con2-alldata | Data | port 3 (ie. `03000800 00040000 C7030000`)\n")])])]),t("p",[e._v("Note that:")]),e._v(" "),t("ul",[t("li",[e._v("port 1 would be labeled as "),t("code",[e._v("con0")])]),e._v(" "),t("li",[e._v("port 1's BusID is set to "),t("code",[e._v("01")])]),e._v(" "),t("li",[e._v("port 2 and 3's BusID are set to "),t("code",[e._v("00")]),e._v(", disabling them")])]),e._v(" "),t("p",[e._v("When done, you should get something similar:")]),e._v(" "),t("p",[t("img",{attrs:{src:a(279),alt:""}})]),e._v(" "),t("p",[e._v("And as mentioned before, if this combo doesn't work, increment port 1's BusID and if that doesn't work disable port 1's busID and try port 2 and so forth.")])])}),[],!1,null,null,null);t.default=n.exports}}]);