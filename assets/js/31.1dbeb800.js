(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{283:function(t,e,a){t.exports=a.p+"assets/img/vram.9d04ab0c.png"},435:function(t,e,a){"use strict";a.r(e);var n=a(10),l=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"patching-vram"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#patching-vram"}},[t._v("#")]),t._v(" Patching VRAM")]),t._v(" "),e("p",[t._v("This section is mainly relevant for users who cannot unlock their BIOS to increase the allocated VRAM for their iGPU which results in a kernel panic in macOS. To work around this, we'll first want to identify the minimum amount of VRAM required for the framebuffer and then patch it to require less.")]),t._v(" "),e("p",[t._v("For this example, let's take a Haswell Lake Framebuffer that's commonly used on desktop Haswell iGPUs: "),e("code",[t._v("0x0D220003")]),t._v("("),e("code",[t._v("0300220D")]),t._v(" when hex swapped)")]),t._v(" "),e("p",[t._v("Now let's take a look at the corresponding information in "),e("a",{attrs:{href:"https://github.com/acidanthera/WhateverGreen/blob/master/Manual/FAQ.IntelHD.en.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("WhateverGreen's manual"),e("OutboundLink")],1),t._v('(note you\'ll need to click "Spoiler: Azul connectors")')]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 0D220003, STOLEN: 32 MB, FBMEM: 19 MB, VRAM: 1536 MB, Flags: 0x00000402\nTOTAL STOLEN: 52 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 116 MB, MAX OVERALL: 117 MB (123219968 bytes)\nCamellia: CamelliaDisabled (0), Freq: 5273 Hz, FreqMax: 5273 Hz\nMobile: 0, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x00000087 - ConnectorDP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x00000087 - ConnectorDP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x00000011 - ConnectorDP\n01050900 00040000 87000000\n02040A00 00040000 87000000\n03060800 00040000 11000000\n")])])]),e("p",[t._v("Here what matters is the first 2 lines:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 0D220003, STOLEN: 32 MB, FBMEM: 19 MB, VRAM: 1536 MB, Flags: 0x00000402\nTOTAL STOLEN: 52 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 116 MB, MAX OVERALL: 117 MB (123219968 bytes)\n")])])]),e("p",[t._v("Here the main entries we care about:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Entry")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comment")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("STOLEN")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("32MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Memory reserved for the iGPU")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("FBMEM")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("19MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Memory reserved for the framebuffer")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("TOTAL CURSOR")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("1 MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Memory reserved for cursor")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("TOTAL STOLEN")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("52 MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Combination of the above")])])])]),t._v(" "),e("p",[t._v("Now let's say for example your motherboard only allocates 32MB for the iGPU, this will be too little for what the framebuffer expects and so will most likely kernel panic when it tries to write into an area of memory that does not exist.")]),t._v(" "),e("p",[t._v("That's where WhateverGreen's patching capabilities come in, here we're able to set the exact amount of iGPU memory the framebuffer expects with the following properties:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comment")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-patch-enable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("This enables WhateverGreen's patching capabilities")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-stolenmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("This sets the value used by "),e("code",[t._v("STOLEN")]),t._v(" entry")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-fbmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("This sets the value used by "),e("code",[t._v("FBMEM")]),t._v(" entry")])])])]),t._v(" "),e("h2",{attrs:{id:"creating-our-patch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creating-our-patch"}},[t._v("#")]),t._v(" Creating our patch")]),t._v(" "),e("p",[t._v("So to lower this VRAM requirement, we'll want to set "),e("code",[t._v("STOLEN")]),t._v(" to 19MB and "),e("code",[t._v("FBMEM")]),t._v(" to 9MB. This will get us underneath the 32MB limit.")]),t._v(" "),e("p",[t._v("To do this, we run the following commands to covert 9MB:")]),t._v(" "),e("div",{staticClass:"language-md extra-class"},[e("pre",{pre:!0,attrs:{class:"language-md"}},[e("code",[e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" Convert 9MB Megabytes to Bytes")]),t._v("\necho '9 "),e("span",{pre:!0,attrs:{class:"token italic"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token content"}},[t._v(" 1024 ")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")])]),t._v(" 1024' | bc\n 9437184\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" Convert from decimal to hexadecimal")]),t._v("\necho 'obase=16; ibase=10; 9437184' | bc\n 900000\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" Hexswap so it can be injected correctly")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" ie. swap in pairs")]),t._v("\n900000 -> 90 00 00 -> 00 00 90\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" Pad the value to 4 bytes with 00 at the end")]),t._v("\n00 00 90 00\n")])])]),e("p",[t._v("And when we do this for both value, we get:")]),t._v(" "),e("ul",[e("li",[t._v("19MB = "),e("code",[t._v("00 00 30 01")])]),t._v(" "),e("li",[t._v("9MB = "),e("code",[t._v("00 00 90 00")])])]),t._v(" "),e("p",[t._v("And when we punch it into our WhateverGreen properties:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Key")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Type")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-patch-enable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("01000000")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-stolenmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("00003001")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-fbmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("00009000")])])])]),t._v(" "),e("ul",[e("li",[t._v("For "),e("code",[t._v("patch-enable")]),t._v(", 01000000 simply refers to being enabled")])]),t._v(" "),e("h2",{attrs:{id:"applying-our-patch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#applying-our-patch"}},[t._v("#")]),t._v(" Applying our patch")]),t._v(" "),e("p",[t._v("Now with our patch made, head into your config.plist then under "),e("code",[t._v("DeviceProperties -> Add -> PciRoot(0x0)/Pci(0x2,0x0)")]),t._v(" and add the properties:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(283),alt:""}})])])}),[],!1,null,null,null);e.default=l.exports}}]);