<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>USB Mapping | OpenCore Post-Install</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="&#39;stylesheet" href="/OpenCore-Post-Install/styles/website.css">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/OpenCore-Post-Install/assets/css/0.styles.272ad498.css" as="style"><link rel="preload" href="/OpenCore-Post-Install/assets/js/app.360e27c7.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/2.ec2b8a26.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/3.a09ecbac.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/29.c396a41a.js" as="script"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/10.7be1d17a.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/11.6ae33852.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/12.c698895a.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/13.cf38fa4f.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/14.5246be2d.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/15.3cce6ffb.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/16.a91fc54e.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/17.5cd9f2be.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/18.9c057150.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/19.e2d1c869.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/20.c9174914.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/21.ca4a18f0.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/22.6d1cfff8.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/23.8f647aca.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/24.e7a6dc2c.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/25.00ff2f69.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/26.19cca4a4.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/27.ccca4918.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/28.4ecd01a3.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/30.5ebf68c2.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/31.2c2b1b42.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/32.24d69541.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/33.c48b184f.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/34.f6fbfe89.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/35.8ca33e45.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/36.63d31246.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/37.3dc8655b.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/38.a4014a3a.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/4.7cb87cc8.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/5.6e1883c5.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/6.29deb4ff.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/7.2ee23b98.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/8.4fb751ed.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/9.6bb400c5.js">
    <link rel="stylesheet" href="/OpenCore-Post-Install/assets/css/0.styles.272ad498.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/OpenCore-Post-Install/" class="home-link router-link-active"><img src="/OpenCore-Post-Install/homepage.png" alt="OpenCore Post-Install" class="logo"> <span class="site-name can-hide">OpenCore Post-Install</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Dortania Guides" class="dropdown-title"><span class="title">Dortania Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dortania.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home Site
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/OpenCore-Install-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OpenCore Install Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Getting-Started-With-ACPI/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Getting Started With ACPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/GPU-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GPU Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Wireless-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Wireless Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Anti-Hackintosh-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Anti Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/dortania/OpenCore-Post-Install" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Dortania Guides" class="dropdown-title"><span class="title">Dortania Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dortania.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home Site
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/OpenCore-Install-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OpenCore Install Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Getting-Started-With-ACPI/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Getting Started With ACPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/GPU-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GPU Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Wireless-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Wireless Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Anti-Hackintosh-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Anti Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/dortania/OpenCore-Post-Install" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/" aria-current="page" class="sidebar-link">OpenCore Post-Install</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Universal</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/universal/security.html" class="sidebar-link">Security and FileVault</a></li><li><a href="/OpenCore-Post-Install/universal/audio.html" class="sidebar-link">Fixing Audio</a></li><li><a href="/OpenCore-Post-Install/universal/oc2hdd.html" class="sidebar-link">Booting without USB</a></li><li><a href="/OpenCore-Post-Install/universal/update.html" class="sidebar-link">Updating OpenCore, kexts and macOS</a></li><li><a href="/OpenCore-Post-Install/universal/drm.html" class="sidebar-link">Fixing DRM</a></li><li><a href="/OpenCore-Post-Install/universal/iservices.html" class="sidebar-link">Fixing iServices</a></li><li><a href="/OpenCore-Post-Install/universal/pm.html" class="sidebar-link">Fixing Power Management</a></li><li><a href="/OpenCore-Post-Install/universal/sleep.html" class="sidebar-link">Fixing Sleep</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>USB Fixes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/usb/" aria-current="page" class="sidebar-link">USB Mapping: Introduction</a></li><li><a href="/OpenCore-Post-Install/usb/system-preparation.html" class="sidebar-link">System Preparation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>USB Mapping</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/usb/intel-mapping/intel.html" class="sidebar-link">Intel USB mapping</a></li><li><a href="/OpenCore-Post-Install/usb/manual/manual.html" aria-current="page" class="active sidebar-link">Manual Mapping</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#usb-mapping-the-manual-way" class="sidebar-link">USB Mapping: The manual way</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#finding-your-usb-ports" class="sidebar-link">Finding your USB ports</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#finding-which-ports-match-with-which-controller" class="sidebar-link">Finding which ports match with which controller</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#usb-a-mapping" class="sidebar-link">USB-A mapping</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#creating-a-personal-map" class="sidebar-link">Creating a personal map</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#usb-c-mapping" class="sidebar-link">USB-C mapping</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#continuing-mapping" class="sidebar-link">Continuing mapping</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#special-notes" class="sidebar-link">Special Notes</a></li></ul></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#creating-our-kext" class="sidebar-link">Creating our kext</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#determining-the-properties" class="sidebar-link">Determining the properties</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#ioprovidermergeproperties" class="sidebar-link">IOProviderMergeProperties</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#continuing-on" class="sidebar-link">Continuing on</a></li></ul></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/usb/manual/manual.html#cleaning-up" class="sidebar-link">Cleaning up</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Miscellaneous Fixes</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Laptop Specifics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/laptop-specific/battery.html" class="sidebar-link">Fixing Battery Read-outs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Cosmetics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/cosmetic/verbose.html" class="sidebar-link">Fixing Resolution and Verbose</a></li><li><a href="/OpenCore-Post-Install/cosmetic/gui.html" class="sidebar-link">Add GUI and Boot-chime</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Multiboot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/multiboot/bootstrap.html" class="sidebar-link">Setting up Bootstrap.efi</a></li><li><a href="/OpenCore-Post-Install/multiboot/bootcamp.html" class="sidebar-link">Installing BootCamp</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/misc/rtc.html" class="sidebar-link">Fixing RTC</a></li><li><a href="/OpenCore-Post-Install/misc/msr-lock.html" class="sidebar-link">Fixing CFG Lock</a></li><li><a href="/OpenCore-Post-Install/misc/nvram.html" class="sidebar-link">Emulated NVRAM</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-succinct-content content__default"><h1 id="usb-mapping"><a href="#usb-mapping" class="header-anchor">#</a> USB Mapping</h1> <p>So with the prerequisites out of the way, we can finally get to the meat of this guide. And now we get to finally read one of my favourite books before I go to bed each night: <a href="https://uefi.org/sites/default/files/resources/ACPI_6_3_final_Jan30.pdf" target="_blank" rel="noopener noreferrer">The Advanced Configuration and Power Interface (ACPI) Specification!<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Now if you haven't read through this before(which I highly recommend you do, it's a thrilling tale), I'll point you to the meat of the USB situation:</p> <ul><li>Section 9.14: _UPC (USB Port Capabilities)</li></ul> <p>Here we're greeted with all the possible USB ports in ACPI:</p> <table><thead><tr><th style="text-align:left;">Type</th> <th style="text-align:left;">Info</th> <th style="text-align:left;">Comments</th></tr></thead> <tbody><tr><td style="text-align:left;">0</td> <td style="text-align:left;">USB 2.0 Type-A connector</td> <td style="text-align:left;">This is what macOS will default all ports to when no map is present</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">USB 3.0 Type-A connector</td> <td style="text-align:left;">3.0, 3.1 and 3.2 ports share the same Type</td></tr> <tr><td style="text-align:left;">8</td> <td style="text-align:left;">Type C connector - USB 2.0-only</td> <td style="text-align:left;">Mainly seen in phones</td></tr> <tr><td style="text-align:left;">9</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 with Switch</td> <td style="text-align:left;">Flipping the device <strong>does not</strong> change the ACPI port</td></tr> <tr><td style="text-align:left;">10</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 without Switch</td> <td style="text-align:left;">Flipping the device <strong>does</strong> change the ACPI port. generally seen on 3.1/2 motherboard headers</td></tr> <tr><td style="text-align:left;">255</td> <td style="text-align:left;">Proprietary connector</td> <td style="text-align:left;">For Internal USB ports like Bluetooth</td></tr></tbody></table> <h2 id="usb-mapping-the-manual-way"><a href="#usb-mapping-the-manual-way" class="header-anchor">#</a> USB Mapping: The manual way</h2> <p>This section is for those who want to get down into the meats of their hackintosh, to really understand what it's doing and help if there's any issues with USBmap.py and other mapping tools. To start, we'll need a few things:</p> <ul><li>Installed version of macOS
<ul><li>This is due to how macOS enumerates ports, trying to map from other OSes makes this difficult</li> <li>Note: This guide will be focusing on OS X 10.11, El Capitan and newer. Older OSes shouldn't require any USB mapping</li></ul></li> <li>Non-conflicting USB names
<ul><li>See previous section: <a href="/OpenCore-Post-Install/usb/system-preparation.html#checking-what-renames-you-need">Checking what renames you need</a></li></ul></li> <li>A USB 2.0 and USB 3.0 device to test with
<ul><li>You must have 2 separate devices as to ensure no mix ups with personalities</li></ul></li> <li><a href="https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-302.zip" target="_blank" rel="noopener noreferrer">IORegistryExplorer.app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>To view the inner workings of macOS more easily</li> <li>If you plan to use Discord for troubleshooting, <a href="https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-210.zip" target="_blank" rel="noopener noreferrer">v2.1.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a bit easier on file size.</li></ul></li> <li><a href="">USBInjectAll</a> <ul><li>This is only required for older USB controllers like Broadwell and older, however some Coffee Lake systems may still require it</li> <li><strong>Reminder</strong> this kext does not work on AMD</li></ul></li> <li><a href="https://github.com/dortania/OpenCore-Post-Install/blob/master/extra-files/Sample-USB-Map.kext.zip" target="_blank" rel="noopener noreferrer">Sample-USB-Map.kext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/corpnewt/ProperTree" target="_blank" rel="noopener noreferrer">ProperTree<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>Or any other plist editor</li></ul></li></ul> <p>Now with all this out of the way, lets get to USB mapping!</p> <h2 id="finding-your-usb-ports"><a href="#finding-your-usb-ports" class="header-anchor">#</a> Finding your USB ports</h2> <p>Lets open our previously downloaded <a href="https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-302.zip" target="_blank" rel="noopener noreferrer">IORegistryExplorer.app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and search for our USB controller(s).</p> <p>The 2 main search terms are <code>XHC</code> and <code>EHC</code>, but if you have a legacy board with UHCI or OHCI controllers you'll need to adjust. A blanket <code>USB</code> search may show too many entries and confuse you.</p> <p>For this example, lets try and map an Asus X299-E Strix board:</p> <p><img src="/OpenCore-Post-Install/assets/img/initial-boot.6a3eae3f.png" alt=""></p> <p>From the above image we can see 3 USB controllers:</p> <ul><li>PXSX(1, Top)</li> <li>PXSX(2, Middle)</li> <li>XHCI(3, Bottom)</li></ul> <p>Pay attention that they're individual controllers, as this means <strong>each USB controller has it's own port limit</strong>. So you're not as starved for USB ports as you may think.</p> <p>Now I personally know which USB controllers match up with which physical ports, problem is it's not always as obvious which ports match with which controllers. So lets try to figure out which is what.</p> <p><strong>Note</strong>: The AppleUSBLegacyRoot entry is an entry that lists all active USB controllers and ports, these are not USB controllers themselves so you can outright ignore them.</p> <p><strong>Note 2</strong>: Keep in mind every motherboard model will have a unique set of port combos, controller types and names. So while our example uses PXSX, yours might have have the XHC0 or PTCP name. And quite common on older motherboards is that you may only have 1 controller, this is alright so don't stress about having the exact same setup as the example.</p> <p>Common names you can check:</p> <ul><li>USB 3.x controllers:
<ul><li>XHC</li> <li>XHC0</li> <li>XHC1</li> <li>XHC2</li> <li>XHCI</li> <li>XHCX</li> <li>AS43</li> <li>PTXH
<ul><li>Commonly associated with AMD Chipset controllers</li></ul></li> <li>PTCP
<ul><li>Found on AsRock X399</li></ul></li> <li>PXSX
<ul><li>This is a generic PCIe device, <strong>double check it's a USB device</strong> as NVMe controllers and other devices can use the same name.</li></ul></li></ul></li> <li>USB 2.x controllers:
<ul><li>EHCI</li> <li>EHC1</li> <li>EHC2</li> <li>EUSB</li> <li>USBE</li></ul></li></ul> <h3 id="finding-which-ports-match-with-which-controller"><a href="#finding-which-ports-match-with-which-controller" class="header-anchor">#</a> Finding which ports match with which controller</h3> <p>To start, I'm going to plug a USB device into my front USB 3.1(Type-A) and 3.2(Type-C):</p> <p><img src="/OpenCore-Post-Install/assets/img/front-io-plugged.7e34db4c.png" alt=""></p> <p>Next lets look at IOReg, and we can see where our USB devices fell:</p> <table><thead><tr><th style="text-align:left;">USB-C</th> <th style="text-align:left;">USB-A</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/usb-c-test.6e512b44.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/usb-a-test-3.8ad1d384.png" alt=""></td></tr></tbody></table> <p>Here we see a few things:</p> <ul><li>Front 3.2 Type-C is on the PXSX(2, middle) Controller</li> <li>Front 3.1 Type-A is on the XHCI(3, Bottom) Controller</li></ul> <p>Now that we have an idea of which ports go to which controller, can can now look into how we USB map.</p> <h3 id="usb-a-mapping"><a href="#usb-a-mapping" class="header-anchor">#</a> USB-A mapping</h3> <p>As mentioned before, USB 3.x ports are split into 2 personalities: USB 2.0 and USB 3.0. This is to ensure backwards compatibility but macOS itself has difficulties determining which personalities match up to which ports. That's where we come in to help.</p> <p>So lets take our USB-A port, when we plug in a USB 3.0 device into it we see <code>XHCI -&gt; SS03</code> light up. This is the USB 3.0 personality of the port. Now we'll want to plug a USB 2.0 device into that port:</p> <table><thead><tr><th style="text-align:left;">3.0 Personality</th> <th style="text-align:left;">2.0 Personality</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/usb-a-test-4.a06acca3.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/usb-a-test-2.0d237546.png" alt=""></td></tr></tbody></table> <p>We see that the USB 2.0 personality of our 3.0 port is <code>XHCI -&gt; HS03</code>, now you should be able to get an idea of what we're trying to do:</p> <ul><li>Front Type-A:
<ul><li>HS03: 2.0 Personality</li> <li>SS03: 3.0 Personality</li></ul></li></ul> <p><strong>Note</strong>: If your USB ports show up as either AppleUSB20XHCIPort or AppleUSB30XHCIPort, you can still map however it will be a bit more difficult. Instead of writing down the names, pay very close attention to the <code>port</code> property on the right hand side:</p> <p><img src="/OpenCore-Post-Install/assets/img/location-id.0e09ce14.png" alt=""></p> <h3 id="creating-a-personal-map"><a href="#creating-a-personal-map" class="header-anchor">#</a> Creating a personal map</h3> <p>This is where we pull out out pen and paper, and start to write down which ports physically match up with which digital ports. An example of what your map can look like:</p> <table><thead><tr><th style="text-align:left;">Name Mapping</th> <th style="text-align:left;">Property Mapping</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/front-io-diagram.6debd359.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/full-diagram-port.95a0acd7.png" alt=""></td></tr></tbody></table> <p>Your own map doesn't need to look exactly like this, however you'll want something that you can easily understand and refer to down the line.</p> <p>Note:</p> <ul><li>Name Mapping: When a proper name shows up in IOReg(ie. HS01)</li> <li>Property Mapping: When no proper name is given(ie. AppleUSB30XHCIPort)</li></ul> <h3 id="usb-c-mapping"><a href="#usb-c-mapping" class="header-anchor">#</a> USB-C mapping</h3> <p>Next lets map our USB-C port, this is where it gets quite tricky as you may have noticed earlier:</p> <table><thead><tr><th style="text-align:left;">Type</th> <th style="text-align:left;">Info</th> <th style="text-align:left;">Comments</th></tr></thead> <tbody><tr><td style="text-align:left;">8</td> <td style="text-align:left;">Type C connector - USB 2.0-only</td> <td style="text-align:left;">Mainly seen in phones</td></tr> <tr><td style="text-align:left;">9</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 with Switch</td> <td style="text-align:left;">Flipping the device <strong>does not</strong> change the ACPI port</td></tr> <tr><td style="text-align:left;">10</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 without Switch</td> <td style="text-align:left;">Flipping the device <strong>does</strong> change the ACPI port. generally seen on 3.1/2 motherboard headers</td></tr></tbody></table> <p>So when we map our USB-C header, we notice it occupies the SS01 port. But when we flip it, we actually populate it on the SS02 port. When this happens, you'll want to write this down for when we apply the port type.</p> <ul><li>Note: All personalities from this port will be put under the Type 10</li> <li>Note 2: Not all USB-C headers will be Type 10, <strong>double check yours</strong></li></ul> <p><img src="/OpenCore-Post-Install/assets/img/usb-c-test-2.ac6df531.png" alt=""></p> <h3 id="continuing-mapping"><a href="#continuing-mapping" class="header-anchor">#</a> Continuing mapping</h3> <p>Now that you have the basic idea, you'll want to go around with every USB port and map it out. This will take time, and don't forget to write it down. Your final diagram should look similar to this:</p> <p><img src="/OpenCore-Post-Install/assets/img/full-diagram.df6685c2.png" alt=""></p> <h3 id="special-notes"><a href="#special-notes" class="header-anchor">#</a> Special Notes</h3> <ul><li><a href="#bluetooth">Bluetooth</a></li> <li><a href="#usrx-ports">USRx Ports</a></li> <li><a href="#missing-usb-ports">Missing USB Ports</a></li></ul> <h4 id="bluetooth"><a href="#bluetooth" class="header-anchor">#</a> Bluetooth</h4> <p>So while not obvious to many, Bluetooth actually runs over the USB interface internally. This means that when mapping, you'll need to pay close attention to devices that already show up in IOReg:</p> <p><img src="/OpenCore-Post-Install/assets/img/bluetooth.cb166ecb.png" alt=""></p> <p>Keep this in mind, as this plays into the Type 255 and getting certain services like handoff working correctly.</p> <h4 id="usrx-ports"><a href="#usrx-ports" class="header-anchor">#</a> USRx Ports</h4> <p>When mapping, you may notice some extra ports left over, specifically USR1 and USR2. These ports are known as &quot;USBR&quot; ports, or more specifically <a href="https://software.intel.com/content/www/us/en/develop/documentation/amt-developer-guide/top/storage-redirection.html" target="_blank" rel="noopener noreferrer">USB Redirection Ports<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Use of these is for remote management but real Macs don't ship with USBR devices and so has no support for them OS-wise. You can actually ignore these entries in your USB map:</p> <p><img src="/OpenCore-Post-Install/assets/img/usr.f0bf7e0c.png" alt=""></p> <h4 id="missing-usb-ports"><a href="#missing-usb-ports" class="header-anchor">#</a> Missing USB ports</h4> <p>In some rare situations, certain USB ports may not show up in macOS at all. This is likely due to a missing definition in your ACPI tables, and so we have a few options:</p> <ul><li>Coffee Lake and older should use <a href="https://github.com/Sniki/OS-X-USB-Inject-All/releases" target="_blank" rel="noopener noreferrer">USBInjectAll<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>Don't forget to add this to both EFI/OC/Kexts and you config.plist's kernel -&gt; Add</li></ul></li> <li>Comet Lake and newer should use SSDT-RHUB</li> <li>AMD systems should also use SSDT-RHUB</li></ul> <p>SSDT-RHUB's purpose is to reset your USB controller, and force macOS to reenumerate them. This avoids the hassle of trying to patch your existing ACPI tables.</p> <p>To create your own SSDT-RHUB-MAP:</p> <ul><li>Grab a copy of the SSDT: <a href="https://github.com/dortania/Getting-Started-With-ACPI/blob/master/extra-files/decompiled/SSDT-RHUB.dsl" target="_blank" rel="noopener noreferrer">SSDT-RHUB.dsl<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Grab <a href="https://github.com/acidanthera/MaciASL/releases/tag/1.5.7" target="_blank" rel="noopener noreferrer">maciASL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Next, open our newly downloaded SSDT with maciASL, you should be presented with the following:</p> <p><img src="/OpenCore-Post-Install/assets/img/ssdt-rhub-normal.ae4515de.png" alt=""></p> <p>Now, open IOReg and find the USB controller you want to reset(pay very close attention its the USB controller and not the child RHUB with the same name):</p> <p>If you look to the right side, you should see the <code>acpi-apth</code> property. Here we're going to need to translate it to something our SSDT can use:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># before modifying</span>
IOService:/AppleACPIPlatformExpert/PC00@0/AppleACPIPCI/RP05@1C,4/IOPP/PXSX@0
</code></pre></div><p>Now we'll want to strip out any unnecessary data:</p> <ul><li><code>IOService:/AppleACPIPlatformExpert/</code></li> <li><code>@##</code></li> <li><code>IOPP</code></li></ul> <p>Once cleaned up, yours should look similar:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># After modifying</span>
PC00.RP05.PXSX
</code></pre></div><p>Following the example from above, we'll be renaming <code>PCI0.XHC1.RHUB</code> to <code>PC00.RP05.PXSX.RHUB</code>:</p> <p><strong>Before</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>External (_SB_.PCI0.XHC1.RHUB, DeviceObj) &lt;- Rename this

Scope (_SB.PCI0.XHC1.RHUB) &lt;- Rename this
</code></pre></div><p><img src="/OpenCore-Post-Install/assets/img/ssdt-rhub.c870313a.png" alt=""></p> <p>Following the example pathing we found, the SSDT should look something like this:</p> <p><strong>After</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>External (_SB.PC00.RP05.PXSX.RHUB, DeviceObj) &lt;- Renamed

Scope (_SB.PC00.RP05.PXSX.RHUB) &lt;- Renamed
</code></pre></div><p><img src="/OpenCore-Post-Install/assets/img/ssdt-rhub-fixed.c60433a7.png" alt=""></p> <p>Once you've edited the SSDT to your USB controller's path, you can export it with <code>File -&gt; SaveAs -&gt; ACPI Machine Language Binary</code>:</p> <p><img src="/OpenCore-Post-Install/assets/img/ssdt-save.7aca1f0e.png" alt=""></p> <p>Finally, remember to add this SSDT to both EFI/OC/ACPI and your config.plist under ACPI -&gt; Add.</p> <h2 id="creating-our-kext"><a href="#creating-our-kext" class="header-anchor">#</a> Creating our kext</h2> <p>Its the time you've all been waiting for, we finally get to create our USB map!</p> <p>First off, we'll want to grab a sample USB map kext:</p> <ul><li><a href="https://github.com/dortania/OpenCore-Post-Install/blob/master/extra-files/Sample-USB-Map.kext.zip" target="_blank" rel="noopener noreferrer">Sample-USB-Map.kext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Next right click the .kext, and select <code>Show Package Contents</code>. then drill down to the info.plist:</p> <table><thead><tr><th style="text-align:left;">Show Contents</th> <th style="text-align:left;">info.plist</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/show-contents.6e2ee797.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/info-plist.4270a49f.png" alt=""></td></tr></tbody></table> <p>Now lets open ProperTree and look at this info.plist:</p> <p><img src="/OpenCore-Post-Install/assets/img/info-plist-open.878e50dc.png" alt=""></p> <p>Here we see a few sections, under <code>IOKitPersonalities</code>:</p> <ul><li>RP05 - PXSX(1)</li> <li>RP07 - PXSX(2)</li> <li>XHCI - XHCI</li></ul> <p>Each entry here represents a USB controller, specifically the map for each controller. The names of the entry don't matter much however, it's more for book keeping so you know which entry to has which USB map.</p> <p>Next lets head into the <code>RP05 - PXSX(1)</code> entry:</p> <p><img src="/OpenCore-Post-Install/assets/img/rp05-entry.d5f3ffba.png" alt=""></p> <p>Here we see a few more important properties:</p> <table><thead><tr><th style="text-align:left;">Property</th> <th style="text-align:left;">Comment</th></tr></thead> <tbody><tr><td style="text-align:left;">IOPathMatch</td> <td style="text-align:left;">The device macOS will choose to attach the map to</td></tr> <tr><td style="text-align:left;">IOProviderClass</td> <td style="text-align:left;">The USB driver macOS will choose to attach</td></tr> <tr><td style="text-align:left;">model</td> <td style="text-align:left;">The SMBIOS the USB map attaches too</td></tr> <tr><td style="text-align:left;">IOProviderMergeProperties</td> <td style="text-align:left;">The dictionary holding the actual port map</td></tr></tbody></table> <h3 id="determining-the-properties"><a href="#determining-the-properties" class="header-anchor">#</a> Determining the properties</h3> <p>Determining the value for each property is actually quite straight forward:</p> <ul><li><a href="#iopathmatch">IOPathMatch</a></li> <li><a href="#ioproviderclass">IOProviderClass</a></li> <li><a href="#model">model</a></li> <li><a href="#ioprovidermergeproperties">IOProviderMergeProperties</a></li></ul> <h4 id="iopathmatch"><a href="#iopathmatch" class="header-anchor">#</a> IOPathMatch</h4> <p>Finding IOPathMatch is super easy, first find the USB controller you want to map and then select the Root HUB(so the PXSX child with the same name as the parent, don't worry it's less confusing when you look at the image):</p> <p><img src="/OpenCore-Post-Install/assets/img/iopath-match.94411b7c.png" alt=""></p> <p>Now with the PXSX entry selected, simply copy(Cmd+C) and paste it into our info.plist. Your property should look similar to the below:</p> <div class="language- extra-class"><pre class="language-text"><code>IOService:/AppleACPIPlatformExpert/PC00@0/AppleACPIPCI/RP05@1C,4/IOPP/PXSX@0/PXSX@01000000
</code></pre></div><p><strong>Note</strong>: Each USB Controller will have a unique IOPathMatch value, keep this in mind if you have multiple controllers of the same name. This Asus X299 board has 2 PXSX USB controllers, so each new USB map dictionary will have a unique entry for IOPathMatch.</p> <h4 id="ioproviderclass"><a href="#ioproviderclass" class="header-anchor">#</a> IOProviderClass</h4> <p>Finding IOProviderClass is also easy, select the Root-hub once again and look for the CFBundleIdentifier value:</p> <table><thead><tr><th style="text-align:left;">IOReg</th> <th style="text-align:left;">info.plist</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/ioproviderclass.106aee58.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/iorpoviderclass-plist.1849a764.png" alt=""></td></tr></tbody></table> <p>Now we can't take that value 1-1, instead we need to trim it to the Kext's short name being <code>AppleUSBXHCIPCI</code>(So we removed <code>com.apple.driver.usb.</code>)</p> <h4 id="model"><a href="#model" class="header-anchor">#</a> model</h4> <p>If you've forgotten what SMBIOS you're using, you can simply check the top level device in IOReg:</p> <table><thead><tr><th style="text-align:left;">IOReg</th> <th style="text-align:left;">info.plist</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/smbios.dd36131c.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/smbios-plist.bb87baef.png" alt=""></td></tr></tbody></table> <h3 id="ioprovidermergeproperties"><a href="#ioprovidermergeproperties" class="header-anchor">#</a> IOProviderMergeProperties</h3> <p>Now lets open the IOProviderMergeProperties dictionary:</p> <p><img src="/OpenCore-Post-Install/assets/img/ioprovidermerge.23b33fb1.png" alt=""></p> <p>Here we have a lot of data to work through:</p> <table><thead><tr><th style="text-align:left;">Property</th> <th style="text-align:left;">Comment</th></tr></thead> <tbody><tr><td style="text-align:left;">name</td> <td style="text-align:left;">The name of the USB port's dictionary</td></tr> <tr><td style="text-align:left;">port-count</td> <td style="text-align:left;">This is the largest port value you're injecting</td></tr> <tr><td style="text-align:left;">UsbConnector</td> <td style="text-align:left;">This is the type of USB port as mentioned in the ACPI 9.14 section</td></tr> <tr><td style="text-align:left;">port</td> <td style="text-align:left;">The physical location of your USB port in ACPI</td></tr> <tr><td style="text-align:left;">Comment</td> <td style="text-align:left;">An optional entry to help you keep track of all your ports</td></tr></tbody></table> <p>And a reminder of all possible port types:</p> <table><thead><tr><th style="text-align:left;">Type</th> <th style="text-align:left;">Info</th> <th style="text-align:left;">Comments</th></tr></thead> <tbody><tr><td style="text-align:left;">0</td> <td style="text-align:left;">USB 2.0 Type-A connector</td> <td style="text-align:left;">This is what macOS will default all ports to when no map is present</td></tr> <tr><td style="text-align:left;">3</td> <td style="text-align:left;">USB 3.0 Type-A connector</td> <td style="text-align:left;">3.0, 3.1 and 3.2 ports share the same Type</td></tr> <tr><td style="text-align:left;">8</td> <td style="text-align:left;">Type C connector - USB 2.0-only</td> <td style="text-align:left;">Mainly seen in phones</td></tr> <tr><td style="text-align:left;">9</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 with Switch</td> <td style="text-align:left;">Flipping the device <strong>does not</strong> change the ACPI port</td></tr> <tr><td style="text-align:left;">10</td> <td style="text-align:left;">Type C connector - USB 2.0 and USB 3.0 without Switch</td> <td style="text-align:left;">Flipping the device <strong>does</strong> change the ACPI port. generally seen on 3.1/2 motherboard headers</td></tr> <tr><td style="text-align:left;">255</td> <td style="text-align:left;">Proprietary connector</td> <td style="text-align:left;">For Internal USB ports like Bluetooth</td></tr></tbody></table> <p>It should be coming full circle now, as you can see how our previous work with mapping out our ports works.</p> <h4 id="name"><a href="#name" class="header-anchor">#</a> Name</h4> <p>The name property is actually the name of the USB port's dictionary, and is used solely for house keeping. Keep in mind every USb port you want to use needs to have its own unique USB port dictionary.</p> <p>The name itself holds no value besides showing up in IOReg and so this can be whatever you like. To keep this sane, we use the name already given by our ACPI tables(in this case HS01) but the name can be any 4 character entry. However do not go over this 4 char limit, as unintended side effects can happen.</p> <ul><li>Note: Those with AppleUSB20XHCIPort or AppleUSB30XHCIPort names for USB ports, you should choose a name easy to identify. On intel, this is HSxx for 2.0 personalities and SSxx for 3.0 personalities</li></ul> <p><img src="/OpenCore-Post-Install/assets/img/name.abed48f7.png" alt=""></p> <h4 id="port"><a href="#port" class="header-anchor">#</a> port</h4> <p>To find the <code>port</code> value, simply select your USB port in IOReg and look for the <code>port</code> entry:</p> <table><thead><tr><th style="text-align:left;">IOReg</th> <th style="text-align:left;">info.plist</th></tr></thead> <tbody><tr><td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/port.fe3f2983.png" alt=""></td> <td style="text-align:left;"><img src="/OpenCore-Post-Install/assets/img/port-plist.5263aa29.png" alt=""></td></tr></tbody></table> <p>From here we get <code>&lt;03 00 00 00&gt;</code>, you can simply remove any spaces and add it to your USB map</p> <h4 id="port-count"><a href="#port-count" class="header-anchor">#</a> port-count</h4> <p>The final value remaining, look back at your USB map and see which <code>port</code> entry is the largest:</p> <p><img src="/OpenCore-Post-Install/assets/img/port-count.c2ba2fe1.png" alt=""></p> <p>Here we see the largest in PXSX(1) is <code>&lt;04000000&gt;</code>, do keep in mind that <code>port</code> uses hexadecimal if you get any letters in your USB map.</p> <h3 id="continuing-on"><a href="#continuing-on" class="header-anchor">#</a> Continuing on</h3> <p>Now that we've gone over how to map your USB ports for a specific controller, you should have enough understanding to map more controllers. The sample USB-Map.kext I provided has 3 USB controllers listed in it(PXSX-1, PXSX-2 and XHCI). Remember to edit accordingly and to remove any unnecessary maps.</p> <h2 id="cleaning-up"><a href="#cleaning-up" class="header-anchor">#</a> Cleaning up</h2> <p>Once your saved your USB map's info.plist, remember to add the kext to both your EFI/OC/Kexts and under you config.plist's Kernel -&gt; Add(ProperTree's snapshot can do this for you)</p> <p>Next, remove/disable:</p> <ul><li>USBInjectAll.kext(if you're using it)
<ul><li>Reason for this is USBInjectAll actually breaks how Apple builds port maps. So while it's great for inital port mapping, it can break you final USB map</li></ul></li> <li>XhciPortLimit(Under Kernel -&gt; Quirks)
<ul><li>Now that we're finally under the 15 port limit, we no longer need this hacky fix</li></ul></li></ul> <p>Then reboot, and check IOReg one last time:</p> <p><img src="/OpenCore-Post-Install/assets/img/finished.c7d11f9e.png" alt=""></p> <p>Voila! As you can see, our USB map applied successfully!</p> <p>The main properties to verify are:</p> <ul><li>Correct UsbConnector property on your USB ports</li> <li>Comment applied(if injected)</li> <li>Unused ports were removed</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/15/2020, 2:15:23 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/OpenCore-Post-Install/usb/intel-mapping/intel.html" class="prev">
        Intel USB mapping
      </a></span> <span class="next"><a href="/OpenCore-Post-Install/usb/misc/power.html">
        Fixing USB Power
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><div style="visibility:hidden;display:none;"></div><!----></div></div>
    <script src="/OpenCore-Post-Install/assets/js/app.360e27c7.js" defer></script><script src="/OpenCore-Post-Install/assets/js/2.ec2b8a26.js" defer></script><script src="/OpenCore-Post-Install/assets/js/3.a09ecbac.js" defer></script><script src="/OpenCore-Post-Install/assets/js/29.c396a41a.js" defer></script>
  </body>
</html>
